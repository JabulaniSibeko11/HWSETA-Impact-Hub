@model HWSETA_Impact_Hub.Models.ViewModels.Employers.EmployerCreateVm
@{
    ViewData["Title"] = "Add Employer";
}
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
<link href="~/css/employercreatecss.css" rel="stylesheet" />

<div style="display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:24px;flex-wrap:wrap;gap:12px;">
    <div>
        <div class="hw-page-eyebrow"><i class="bi bi-briefcase me-1"></i>Stakeholder Management</div>
        <h1 class="hw-page-title">Add <span>Employer</span></h1>
    </div>
    <a asp-action="Index" class="hw-btn-outline" style="margin-top:4px;"><i class="bi bi-arrow-left"></i> All Employers</a>
</div>

<div class="hw-layout">
    <div>
        @if (!ViewData.ModelState.IsValid && ViewData.ModelState.TryGetValue(string.Empty, out var re) && re.Errors.Count > 0)
        {
            <div class="hw-val-summary">
                <i class="bi bi-exclamation-circle-fill" style="flex-shrink:0;font-size:16px;margin-top:1px;"></i>
                <div><strong>Please fix:</strong><ul>@foreach(var err in re.Errors){
                <li>@err.ErrorMessage</li>
            }
</ul></div>
        </div>
                }

        <form method="post" id="hw-employer-form">
            @Html.AntiForgeryToken()

            @* ── Identity ── *@
            <div class="hw-card">
                <div class="hw-card-head">
                    <div class="hw-card-icon green"><i class="bi bi-building"></i></div>
                    <div><div class="hw-card-title">Employer Identity</div><div class="hw-card-sub">Core registration and classification details</div></div>
                </div>
                <div class="hw-card-body">
                    <div class="hw-g2" style="margin-bottom:15px;">
                        <div class="hw-field">
                            <label class="hw-field-label">Employer Code <span class="hw-opt">(optional)</span></label>
                            <div class="hw-field-wrap">
                                <i class="bi bi-hash hw-field-ico"></i>
                                <input asp-for="EmployerCode" class="hw-input" placeholder="e.g. EMP-001" />
                            </div>
                        </div>
                        <div class="hw-field">
                            <label class="hw-field-label">Employer Name <span class="hw-req">*</span></label>
                            <div class="hw-field-wrap">
                                <i class="bi bi-building hw-field-ico"></i>
                                <input asp-for="EmployerName" class="hw-input" placeholder="Legal trading name" />
                            </div>
                            <span asp-validation-for="EmployerName" class="hw-field-error"></span>
                        </div>
                    </div>
                    <div class="hw-g2" style="margin-bottom:15px;">
                        <div class="hw-field">
                            <label class="hw-field-label">Registration Type <span class="hw-req">*</span></label>
                            <div class="hw-field-wrap">
                                <i class="bi bi-file-earmark-text hw-field-ico"></i>
                                <select asp-for="RegistrationTypeId" asp-items="Model.RegistrationTypes" class="hw-select">
                                    <option value="">— Select type —</option>
                                </select>
                            </div>
                            <span asp-validation-for="RegistrationTypeId" class="hw-field-error"></span>
                        </div>
                        <div class="hw-field">
                            <label class="hw-field-label">Sector <span class="hw-req">*</span></label>
                            <div class="hw-field-wrap">
                                <i class="bi bi-diagram-3 hw-field-ico"></i>
                                <input asp-for="Sector" class="hw-input" placeholder="e.g. Healthcare, Education" />
                            </div>
                            <span asp-validation-for="Sector" class="hw-field-error"></span>
                        </div>
                    </div>
                    <div class="hw-g2">
                        <div class="hw-field">
                            <label class="hw-field-label">Registration Number <span class="hw-req">*</span></label>
                            <div class="hw-field-wrap">
                                <i class="bi bi-fingerprint hw-field-ico"></i>
                                <input asp-for="RegistrationNumber" class="hw-input" placeholder="e.g. 2005/012345/07" />
                            </div>
                            <span asp-validation-for="RegistrationNumber" class="hw-field-error"></span>
                        </div>
                        <div class="hw-field">
                            <label class="hw-field-label">SETA Levy Number <span class="hw-req">*</span></label>
                            <div class="hw-field-wrap">
                                <i class="bi bi-receipt hw-field-ico"></i>
                                <input asp-for="SetaLevyNumber" class="hw-input" placeholder="e.g. L12345678" />
                            </div>
                            <span asp-validation-for="SetaLevyNumber" class="hw-field-error"></span>
                        </div>
                    </div>
                </div>
            </div>

            @* ── Contact ── *@
            <div class="hw-card">
                <div class="hw-card-head">
                    <div class="hw-card-icon blue"><i class="bi bi-person-lines-fill"></i></div>
                    <div><div class="hw-card-title">Contact Information</div><div class="hw-card-sub">Primary and general contact details</div></div>
                </div>
                <div class="hw-card-body">
                    <div class="hw-g3" style="margin-bottom:15px;">
                        <div class="hw-field">
                            <label class="hw-field-label">Contact Name</label>
                            <div class="hw-field-wrap">
                                <i class="bi bi-person hw-field-ico"></i>
                                <input asp-for="ContactName" class="hw-input" placeholder="Primary contact" />
                            </div>
                        </div>
                        <div class="hw-field">
                            <label class="hw-field-label">Contact Email <span class="hw-req">*</span></label>
                            <div class="hw-field-wrap">
                                <i class="bi bi-envelope hw-field-ico"></i>
                                <input asp-for="ContactEmail" class="hw-input" placeholder="contact@company.co.za" />
                            </div>
                            <span asp-validation-for="ContactEmail" class="hw-field-error"></span>
                        </div>
                        <div class="hw-field">
                            <label class="hw-field-label">Contact Phone</label>
                            <div class="hw-field-wrap">
                                <i class="bi bi-telephone hw-field-ico"></i>
                                <input asp-for="ContactPhone" class="hw-input" placeholder="+27 21 000 0000" />
                            </div>
                        </div>
                    </div>
                    <div style="max-width:50%;">
                        <div class="hw-field">
                            <label class="hw-field-label">General / Switchboard Phone</label>
                            <div class="hw-field-wrap">
                                <i class="bi bi-telephone-fill hw-field-ico"></i>
                                <input asp-for="Phone" class="hw-input" placeholder="Main switchboard number" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            @* ── Address & Status ── *@
            <div class="hw-card">
                <div class="hw-card-head">
                    <div class="hw-card-icon gold"><i class="bi bi-geo-alt"></i></div>
                    <div><div class="hw-card-title">Address &amp; Status</div><div class="hw-card-sub">Physical address and activation state</div></div>
                </div>
                <div class="hw-card-body">
                    <div class="hw-field" style="margin-bottom:15px;">
                        <label class="hw-field-label">Street Address <span class="hw-req">*</span></label>
                        <div class="hw-field-wrap">
                            <i class="bi bi-signpost hw-field-ico"></i>
                            <input asp-for="AddressLine1" class="hw-input" placeholder="Street number and name" />
                        </div>
                        <span asp-validation-for="AddressLine1" class="hw-field-error"></span>
                    </div>
                    <div class="hw-g4" style="margin-bottom:18px;">
                        <div class="hw-field" style="grid-column:span 2;">
                            <label class="hw-field-label">City <span class="hw-req">*</span></label>
                            <div class="hw-field-wrap">
                                <i class="bi bi-buildings hw-field-ico"></i>
                                <input asp-for="City" class="hw-input" placeholder="e.g. Johannesburg" />
                            </div>
                            <span asp-validation-for="City" class="hw-field-error"></span>
                        </div>
                        <div class="hw-field">
                            <label asp-for="ProvinceId" class="hw-field-label">Province <span class="hw-req">*</span></label>
                            <div class="hw-field-wrap">
                                <i class="bi bi-geo-alt hw-field-ico"></i>
                                <select asp-for="ProvinceId" asp-items="Model.Provinces" class="hw-select">
                                    <option value="">— Select —</option>
                                </select>
                            </div>
                            <span asp-validation-for="ProvinceId" class="hw-field-error"></span>
                        </div>
                        <div class="hw-field">
                            <label class="hw-field-label">Postal Code <span class="hw-req">*</span></label>
                            <div class="hw-field-wrap">
                                <i class="bi bi-mailbox hw-field-ico"></i>
                                <input asp-for="PostalCode" class="hw-input" placeholder="e.g. 2000" />
                            </div>
                            <span asp-validation-for="PostalCode" class="hw-field-error"></span>
                        </div>
                    </div>
                    <div class="hw-toggle-row">
                        <div>
                            <div class="hw-toggle-label"><i class="bi bi-broadcast me-2" style="color:var(--hw-green);"></i>Active</div>
                            <div class="hw-toggle-desc">Inactive employers are hidden from new cohort selections.</div>
                        </div>
                        <label class="hw-switch">
                            <input asp-for="IsActive" type="checkbox" checked />
                            <span class="hw-switch-slider"></span>
                        </label>
                    </div>
                </div>
                <div class="hw-card-foot">
                    <button type="submit" class="hw-btn-primary"><i class="bi bi-check-lg"></i> Save Employer</button>
                    <a asp-action="Index" class="hw-btn-outline"><i class="bi bi-x"></i> Cancel</a>
                </div>
            </div>
        </form>
    </div>

    @* Sidebar *@
    <div style="display:flex;flex-direction:column;gap:16px;">
        <div style="background:var(--hw-white);border:1.5px solid var(--hw-border);border-radius:var(--hw-radius-lg);overflow:hidden;">
            <div style="padding:14px 18px;border-bottom:1px solid var(--hw-border);background:var(--hw-offwhite);display:flex;align-items:center;gap:10px;">
                <div style="width:34px;height:34px;border-radius:9px;background:var(--hw-gold-light);color:var(--hw-gold-dark);display:flex;align-items:center;justify-content:center;font-size:15px;flex-shrink:0;"><i class="bi bi-lightbulb"></i></div>
                <div style="font-size:13px;font-weight:700;color:var(--hw-dark);">Setup Guide</div>
            </div>
            <div style="padding:16px 18px;">
                <ul class="hw-tip-list">
                    <li class="hw-tip-item"><i class="bi bi-check-circle-fill"></i>Use a consistent code format (e.g. <code style="font-size:10px;background:#f1f2f5;padding:1px 5px;border-radius:4px;">EMP-001</code>) for easier filtering across reports.</li>
                    <li class="hw-tip-item"><i class="bi bi-check-circle-fill"></i>The <strong>Registration Number</strong> is the CIPC company reg number — format: 2005/012345/07.</li>
                    <li class="hw-tip-item"><i class="bi bi-check-circle-fill"></i>The <strong>SETA Levy Number</strong> links this employer to HWSETA levy records.</li>
                    <li class="hw-tip-item"><i class="bi bi-check-circle-fill"></i>Set the <strong>Contact Email</strong> carefully — it is used for automated notifications.</li>
                    <li class="hw-tip-item"><i class="bi bi-check-circle-fill"></i>For many employers, use <strong>Bulk Upload</strong> on the employer list page with the Excel template.</li>
                </ul>
            </div>
        </div>
        <div style="padding:14px 16px;background:var(--hw-green-light);border:1.5px solid var(--hw-green);border-radius:12px;display:flex;gap:10px;align-items:flex-start;">
            <i class="bi bi-info-circle-fill" style="color:var(--hw-green);font-size:15px;flex-shrink:0;margin-top:1px;"></i>
            <div style="font-size:12px;color:var(--hw-dark);line-height:1.6;">After saving, the employer can be linked to cohorts and will appear in the Cohort Delivery Report.</div>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            document.querySelectorAll('span[data-valmsg-for]').forEach(function(span) {
                if (span.textContent.trim()) {
                    var inp = document.querySelector('[name="' + span.getAttribute('data-valmsg-for') + '"]');
                    if (inp) inp.classList.add('input-error');
                }
            });
        });
    </script>
}
